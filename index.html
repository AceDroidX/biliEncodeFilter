<html>
<html class="mdc-typography">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" type="text/css">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue-pink.min.css" />
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js" type="text/javascript">
    </script>

    <style>
        .mdl-card {
            /*width: fit-content;*/
            width:500px;
            margin-left: auto;
            margin-right: auto;
        }
        .material-icons {
            margin: 10
        }
    </style>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        哔哩哔哩2018新直传压制方案筛选工具web版V1.0
    </title>
</head>

<body>
    <div class="mdl-layout mdl-js-layout">
        <header class="mdl-layout__header mdl-layout__header--scroll">
            <div class="mdl-layout__header-row">
                <!-- Title -->
                <span class="mdl-layout-title">哔哩哔哩2018新直传压制方案筛选工具web版V1.0</span>
                <!-- Add spacer, to align navigation to the right -->
                <div class="mdl-layout-spacer"></div>
                <!-- Navigation -->

            </div>
        </header>
        <div class="mdl-layout__drawer">
            <span class="mdl-layout-title">哔哩哔哩2018新直传压制方案筛选工具web版V1.0</span>
            <nav class="mdl-navigation">
                <!--a class="mdl-navigation__link" href="./about.html">关于作者</a-->
            </nav>
        </div>
        <main class="mdl-layout__content">
            <div class="page-content">
                <!-- Your content goes here -->

                <div class="mdl-card mdl-shadow--2dp" style="margin-top: 50px;">
                    <div class="mdl-card__title">
                        <!--h2 class="mdl-card__title-text"><img src="https://i0.hdslb.com/bfs/activity-plat/cover/20170614/x65z8xpm2z.png" style="width: 100"/-->
                        哔哩哔哩2018新直传压制方案筛选工具web版V1.0
                    </div>
                    <div class="mdl-card__supporting-text">
                        声明:
                        <br>原工具由磁爆线圈-X编写(B站ID: <a href="https://space.bilibili.com/3512816/">磁爆线圈X</a>)
                        <br>基于Microsoft Office Excel VBA
                        <br>可在Windows平台和MacOS平台通用
                        <br>
                        <br>网页版由<a href="https://wangxuxin.github.io">AceDroidX</a>编写
                        <br>
                        <br>适配B站2018新直传规格
                        <br>隶属第七版小白哗哩哔哩免二压完全压制手册：
                        <br><a href="http://42.96.168.211:8088/topics/154">小丸之家</a>
                        <br><a href="https://www.bilibili.com/read/cv311967">bilibili专栏</a>
                        <br>########################################
                        <br>使用此筛选工具前请务必阅读第七版手册!
                        <br>########################################
                        <br>禁止一切形式的修改与再编码!
                        <br>作者保留法律追诉权!
                    </div>
                </div>

                <div class="mdl-card mdl-shadow--2dp" style="margin-top: 50px;">
                    <div class="mdl-card__title" id="p1">
                        
                    </div>
                    <div class="mdl-card__supporting-text">
                        <p id="p2">
                            
                        </p>
                        <form action="#">
                            <div class="mdl-textfield mdl-js-textfield">
                                <input class="mdl-textfield__input" type="text" pattern="-?[0-9]*(\.[0-9]+)?" id="t1" style="display: none;">
                                <label class="mdl-textfield__label" for="sample2"></label> <span class="mdl-textfield__error">Input is not a number!</span>
                            </div>
                        </form>
                    </div>
                    <div class="mdl-card__actions mdl-card--border" id="b1">
                        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="start()">
                            点我运行压制方案筛选程序
                        </button>
                    </div>
                    <div class="mdl-card__actions mdl-card--border" id="b2" style="display: none;">
                        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="start()">
                            确定
                        </button>
                    </div>
                    <div class="mdl-card__actions mdl-card--border" id="b3" style="display: none;">
                        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="boolean=true;start()">
                            是
                        </button>
                        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="boolean=false;start()">
                            否
                        </button>
                    </div>
                </div>

                <div class="mdl-card mdl-shadow--2dp" id="result_card" style="display: none;margin-top: 50px;margin-bottom: 50px;">
                    <div class="mdl-card__title">
                        推荐的压制方案
                    </div>
                    <div class="mdl-card__supporting-text">
                        <p id="result_text">
                        </p>
                    </div>
                </div>

            </div>
        </main>
    </div>



    <script type="text/javascript">
        //document.getElementById("demo").innerHTML = "段落已修改。";
        var p1 = document.getElementById("p1")
        var p2 = document.getElementById("p2")
        var t1 = document.getElementById("t1")
        var b1 = document.getElementById("b1")
        var b2 = document.getElementById("b2")
        var b3 = document.getElementById("b3")

        var state="first"//运行状态
        var short
        var length
        var horizontal//横向
        var boolean=null
        var shortx
        var lengthx
        var division
        var fps
        var dalao
        var vol

        var result

        function start(){
            console.log(state)
            console.log(boolean)
            switch(state){
                case "first":
                first()
                break;

                case "oneB":
                oneB()
                break

                case "oneCheck1":
                oneCheck1()
                break

                case "oneCheck2":
                oneCheck2()
                break

                case "oneCheck3":
                oneCheck3()
                break

                case "filt720p":
                filt720p()
                break

                case "filt720p2":
                filt720p2()
                break

                case "filt720p3":
                filt720p3()
                break
            }
        }

        function first(){
            t1.value=""
            b1.style.display='none'
            t1.style.display='block'
            p1.innerHTML = "压制方案筛选-第1步-A-输入分辨率中较小的数"
            p2.innerHTML = "请输入您从Mediainfo中读到的视频分辨率中较小的数值"
            b2.style.display='block'
            state="oneB"
        }
        function oneB(){
            short=parseInt(document.getElementById("t1").value);
            t1.value=""
            p1.innerHTML = "压制方案筛选-第1步-B-输入分辨率中较大的数"
            p2.innerHTML = "请输入您从Mediainfo中读到的视频分辨率中较大的数值"
            state="oneCheck1"
        }
        function oneCheck1(){
            length=parseInt(document.getElementById("t1").value);
            t1.value=""
            if(short>length){
                alert("您把大数和小数输反了! 请重新确认您的输入!")
                first()
            }
            else if((short/length)<0.375){
                alert("该分辨率比例超限无法上传! 推荐使用≤16.9的比例! 请再次确认您是否输入正确")
                first()
            }else{
                oneCheck2()
            }
        }
        function oneCheck2(){
            t1.style.display='none'
            b2.style.display='none'
            p1.innerHTML = "分辨率选择"
            p2.innerHTML = "您输入的较大的数值，是Mediainfo读到的视频分辨率中左半部分的数字吗?例如1920x1080中的1920?"
            b3.style.display='block'
            state="oneCheck3"
        }
        function oneCheck3(){
            horizontal=boolean
            boolean=0
            t1.value=""
            var tmp=""
            if(horizontal){
                tmp+=length
                tmp+="x"
                tmp+=short
            }else{
                tmp+=short
                tmp+="x"
                tmp+=length
            }
            p1.innerHTML = "分辨率选择"
            p2.innerHTML = "您输入的分辨率("+tmp+")已确认"//，且符合MPEG规范与B站上传范围"
            b2.style.display='block'
            b3.style.display='none'
            checkRes()
        }
        function checkRes(){
            var aaa
            var bbb
            var ccc
            var ddd
            var eee
            if(short<720){
                alert("短边分辨率小于720，将为您自动放大分辨率")
                shortx=720
                aaa=Math.round(720*length/short)
                if(aaa%4==0){
                    lengthx=aaa
                }else{
                    while(aaa%4==0){
                        aaa+=1
                    }
                    lengthx=aaa
                }
            }else if(short>2160||length>3840){
                alert("分辨率超出4K标准，将为您自动推荐缩减分辨率")
                bbb=2160
                ccc=Math.round(bbb*length/short)
                if(ccc>3840){
                    ddd=3840
                    eee=Math.round(short*ddd/length)
                    if(eee%4==0){
                        lengthx=ddd
                        shortx=eee
                    }else{
                        while(eee%4==0){
                            eee-=1
                        }
                        lengthx=ddd
                        shortx=eee
                    }
                }else{//若计算后长边小于等于3840
                    if(ccc%4==0){
                        lengthx=ccc
                        shortx=bbb
                    }else{
                        while(ccc%4==0){
                            ccc-=1
                        }
                        lengthx=ccc
                        shortx=bbb
                    }
                }
            }else{//若既不低于720p又不高于4k
                if(short%4>0){
                    division=1
                    shortx=short+2
                }else{
                    shortx=short
                }
                if(length%4>0){
                    division=1
                    lengthx=length+2
                }else{
                    lengthx=length
                }//720-4k不能被4整除转化
            }//低于720和高于4k裁剪完成
            if(short>=480&&shortx==720&&lengthx>1280){
                shortx=shortx+4
                division=1
            }

            if(shortx==720){
                getfps()
            }else{
                filtOther()
            }
        }
        function getfps(){
            t1.value=""
            b1.style.display='none'
            t1.style.display='block'
            p1.innerHTML = "压制方案筛选-第1.5步-输入帧率"
            p2.innerHTML = "请输入您从Mediainfo中读到的视频帧率："
            b2.style.display='block'
            b3.style.display='none'
            state="filt720p"
        }
        function filt720p(){
            fps=parseInt(document.getElementById("t1").value);
            if(fps<5||fps>144){
                alert(您输入了非法的帧率！请重新确认您的输入！)
                getfps()
            }
            if(fps<48){
                if(short<720){
                    if(horizontal){
                        result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }else{
                        result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }else{
                    if(division==1){
                        if(horizontal){
                            result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }else{
                            result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }
                    }else{
                        result="推荐您的压制方案：<br>\
                                请勾选“保持原分辨率”选框<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }
                showResult()
            }else{
                boolean=null
                t1.style.display='block'
                p1.innerHTML = "压制方案筛选-第2步-大会员画质需求选择"
                p2.innerHTML = "请问您是否需要大会员专属画质？<br>\
                                如果需要，您的大会员粉丝可以得到更好的视频质量，但普通观众只能看到二压后的普通画质。<br>\
                                如不需要，则所有观众都能看到同样的画面（包括高帧率），但视频质量会稍有降低。<br>\
                                ##################################<br>\
                                特别注意！特别注意！特别注意！特别注意！如果您的视频题材是游戏录像、MMD、3DCG这三者其中之一，请直接选择“是”！只有大会员专属画质才能满足这三种题材的需求！"
                b2.style.display='block'
                b3.style.display='none'
                state="filt720p2"
            }
        }
        function filt720p2(){
            dalao=boolean
            if(dalao){
                if(short<720){
                    if(horizontal){
                        result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率B<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }else{
                        result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率B<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }else{
                    if(division==1){
                        if(horizontal){
                            result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率B<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }else{
                            result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率B<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }
                    }else{
                        result="推荐您的压制方案：<br>\
                                请勾选“保持原分辨率”选框<br>\
                                码率：手册中的码率B<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }
                showResult()
            }else{
                boolean=null
                t1.style.display='block'
                p1.innerHTML = "压制方案筛选-第3步-高音质需求选择"
                p2.innerHTML = "请问您是否需要大会员专属音质？<br>\
                                如果需要，您的大会员粉丝可以听到320kbps的高音质，但普通观众只能听到二压后的普通音质。<br>\
                                不管您需不需要，这个选项都不会对画质造成任何影响，这点请您放心。"
                b2.style.display='block'
                b3.style.display='none'
                state="filt720p3"
            }
        }
        function filt720p3(){
            vol=boolean
            if(vol){
                if(short<720){
                    if(horizontal){
                        result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }else{
                        result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }else{
                    if(division==1){
                        if(horizontal){
                            result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }else{
                            result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }
                    }else{
                        result="推荐您的压制方案：<br>\
                                请勾选“保持原分辨率”选框<br>\
                                码率：手册中的码率A<br>\
                                音频：大会员专属音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }
            }else{
                if(short<720){
                    if(horizontal){
                        result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }else{
                        result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }else{
                    if(division==1){
                        if(horizontal){
                            result="推荐您的压制方案：<br>\
                                宽度：" + lengthx + "<br>\
                                高度：" + shortx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }else{
                            result="推荐您的压制方案：<br>\
                                宽度：" + shortx + "<br>\
                                高度：" + lengthx + "<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                        }
                    }else{
                        result="推荐您的压制方案：<br>\
                                请勾选“保持原分辨率”选框<br>\
                                码率：手册中的码率A<br>\
                                音频：普通用户音质<br>\
                                参数：普通分辨率默认参数<br>\
                                "
                    }
                }
            }
            showResult()
        }//720P方案甄选完成
        function filtOther(){

        }
        function showResult(){

        }

        function myrefresh() {
                window.location.reload();
            }
        //setTimeout('myrefresh()',500); //指定1秒刷新一次
    </script>
</body>

</html>